<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>ECMAScript 2015 &amp; Webcomponents</title>
    <link rel="stylesheet" href="css/styles.css"></link>
    <link rel="stylesheet" href="css/font-awesome-4.5.0/css/font-awesome.css"></link>
    <script src="js/lib/webcomponents/webcomponents-lite.min.js" type="text/javascript"></script>
    <script src="js/es5/bundle.js" type="text/javascript"></script>
</head>
<body>
<az-presentation>
    <az-slide id="start" start>
        <div class="title">Prochainement dans vos Navigateurs...</div>
   
        <az-format-code file-name="let es2015 = javascript.next(); // aka ES6">
class Dog extends Animal {
  constructor(name) { 
    super();
    this._name = name;
  }
  sit() { 
    console.log(`Sit ${this._name} !`);
  }
}

        </az-format-code>
    
    
        <az-format-code file-name="WebComponent extends HTML">
&lt;head>
  &lt;link rel="import" href="import-file.html">
&lt;/head>

&lt;body>

  &lt;template>
    &lt;p> Will not be rendered &lt;/p>
  &lt;template>

  &lt;my-form custom="true">
    &lt;my-button my-attribute="value"> GO &lt;/my-button>
  &lt;/my-form>
  
&lt;/body>
        </az-format-code>
    
    </az-slide>

    <az-slide>
    <div class="title">Support des Browsers</div>
    
	
    
    <table class="support-table" width="100%">
    <thead>
    <tr>
    <th width="30%"></th>
    <th><i class="fa fa-firefox"></i></th>
    <th><i class="fa fa-chrome"></i></th>
    <th><i class="fa fa-internet-explorer"></i></th>
    <th><i class="fa fa-edge"></i></th>
    <th><i class="fa fa-safari"></i></th>
    <th><i class="fa fa-opera"></i></th>
    </tr>
    </thead>
    <tbody>
     <tr>
      <td>ES2015</td>
      <td class="warn">75%</td>
      <td class="warn">65%</td>
      <td class="ko">16%</td>
      <td class="warn">83%</td>
      <td class="warn">56%</td>
      <td class="warn">65%</td>
    </tr>
    <tr>
      <td>Custom Element</td>
      <td><i class="fa fa-warning warn"></i></td>
      <td><i class="fa fa-check ok"></i></td>
      <td><i class="fa fa-close ko"></i></td>
      <td><i class="fa fa-close ko"></i></td>
      <td><i class="fa fa-close ko"></i></td>
      <td><i class="fa fa-check ok"></i></td>
    </tr>
    <tr>
      <td>HTML Imports</td>
      <td><i class="fa fa-warning warn"></i></td>
      <td><i class="fa fa-check ok"></i></td>
      <td><i class="fa fa-close ko"></i></td>
      <td><i class="fa fa-close ko"></i></td>
      <td><i class="fa fa-warning warn"></i></td>
      <td><i class="fa fa-check ok"></i></td>
    </tr>
    <tr>
      <td>Templates</td>
      <td><i class="fa fa-check ok"></i></td>
      <td><i class="fa fa-check ok"></i></td>
      <td><i class="fa fa-check ok"></i></td>
      <td><i class="fa fa-check ok"></i></td>
      <td><i class="fa fa-check ok"></i></td>
      <td><i class="fa fa-check ok"></i></td>
    </tr>
    <tr>
      <td>Shadow DOM</td>
      <td><i class="fa fa-warning warn"></i></td>
      <td><i class="fa fa-check ok"></i></td>
      <td><i class="fa fa-close ko"></i></td>
      <td><i class="fa fa-close ko"></i></td>
      <td><i class="fa fa-close ko"></i></td>
      <td><i class="fa fa-check ok"></i></td>
    </tr>
    </tbody>
    </table>
    
    <p> ECMAScript 2015 => Transpiler via Babeljs</p>
    <p> Webcomponents => Polyfills </p>
    
    </az-slide>
    
    
    <az-slide>
        <div class="title"><i class="fa fa-terminal"></i> npm install tout-ce-qu-il-faut </div>
        
        <az-format-code file-name="Download">
let codeur = new Coder();

let nav = new Coder().getNavigateurPrefere();

nav.visit( "http://webcomponents.org/polyfills/" ).download( "Web components Polyfills" ); 

nav.visit( "https://nodejs.org/en/download/" ).download( "Node.js" ); 

codeur.use("Node.js").to( build() ).and( transpile(ES2015).to(ES5) );
        </az-format-code>
        
        <az-format-code file-name="cmd >" lang="cmd">
npm install webpack -g

npm install --save-dev babel-loader babel-preset-es2015 raw-loader html-loader script-loader style-loader css-loader

webpack --progress --colors --watch
        </az-format-code>
    </az-slide>

    <az-slide>
      <div class="title"><i class="fa fa-folder-open"></i> Arborescence proposée</div>
        <az-format-code lang="tree">
index.html
css
└─styles.css
js
└─webpack.config.js
└─main.js
└─lib
│ └─google-code-prettify
│ │ └─...  // prettify js lib
│ └─webcomponents
│   └─... // webcomponents polyfill
└─es2015
│ └─...  // place your es2015 code here !
└─es5
  └─...  // es5 bundle and old es5 scripts will be placed here
        </az-format-code>
        
    </az-slide>
    
    <az-slide>   
        <div class="title">Configuration de Webpack</div>
        <az-format-code file-name="js/webpack.config.js">
path = require('path');
module.exports = {
    entry: "./main.js",
    output: {
        path: path.join(__dirname, 'es5'),
        filename: "bundle.js"
    },
    module: {
        loaders: [
            { test: /\.css$/, loader: "style!css" },
            { test: /\.js$/, loader: 'babel-loader', 
                include: [ path.resolve(__dirname, "es2015") ], 
                query: { presets: ['es2015'] } }
        ]
    },
    resolve: {
        alias: {
            prettify: path.join(__dirname,'lib/google-code-prettify'),
            webcomponents: path.join(__dirname,'lib/webcomponents/webcomponents.js')
        }
    }
};
        </az-format-code>
        
        <az-format-code file-name="js/main.js">
require("./es2015/components/az-format-code/az-format-code.js");
require("./es2015/components/az-presentation/az-presentation.js");
        </az-format-code>
    </az-slide>
    


    <az-slide>
		<div class="title">ECMAScript 2015</div>
		<ul>
			<li><a href="http://babeljs.io/repl/">REPL (http://babeljs.io/repl/)</a></i>
			<li><a href="https://babeljs.io/docs/learn-es2015/#ecmascript-6-features">Features (https://babeljs.io/docs/learn-es2015/#ecmascript-6-features)</a></i>
			<li><a href="http://es6-features.org/">Features (http://es6-features.org/)</a></i>

		</ul>
    </az-slide>
    
	<az-slide>
	
		<div class="title">Classes</div>
        <az-format-code file-name="import class.subset as syntactic.sugar from 'OOP'">
class Animal{
    static race() { return "Animal"; }
}
class Dog extends Animal{
    constructor(name) { super();this._name = name; }
    sit() { console.log(`Sit ${this._name} !`);}
}
let rex = new Dog('Rex');
rex.sit();
console.log(`${rex._name} is an ${Dog.race()}`); // Rex is an Animal
		</az-format-code>
	</az-slide>
	<az-slide>
		<div class="title">!Classes</div>
        <az-format-code file-name="es2015.class !== OOP.class">
class Cat extends Animal {

  // KO : pas d'attributs, il faut utiliser le constructeur
  <del>let _name = "Moustache";</del> 

  constructor(name = "Moustache") { this._name = name; } // OK

  // KO : pas de modificateur de visibilité, jouer sur les imports/exports ou utiliser des astuces (WeakMap par ex)
  <del>private privateMethod(){ }</del> 

  static race() {
    return "CAT("+super.race()+")"; //  OK : oui on peut appeler super en static !
  } 
}
        </az-format-code>
    </az-slide>
	<az-slide>	
		<div class="title">let, const & default value</div>
		<az-format-code file-name="let = block scoped var">
for(let i = 0 ; i < 5 ; i++) {
  var a = i + 1; // var : scope fonction|global
  let b = i - 1; // let : scope {block}
}
console.log(`a = ${a}`); // a = 5
<del>console.log(`b = ${b}`);</del> // b is not defined
		</az-format-code>
		<az-format-code file-name="const = immutable let">
{
  const c = 5;
  <del>c= 4;</del> // erreur: ne peut être réassigné
}
<del>console.log(`c = ${c}`);</del> // const est également block scoped
		</az-format-code>
<az-format-code file-name="default value">		
function f(a, b = 3) {
  return a * b;
}
console.log(`f(3) = ${f(3)}`); // f(3) = 9
console.log(`f(3, 4) = ${f(3, 4)}`); // f(3, 4) = 12		
</az-format-code>		
		
 </az-slide>
	<az-slide>	
		<div class="title">`${title}`</div>		
		<az-format-code file-name="String interpolation ... ">
const n = 5, str="ok";
console.log(`This String 
can have
multiple
lines = and interpolate valus like :${n}  ${str} and even ${str.length*n}`);
		</az-format-code>
		
				<az-format-code file-name="... mais pas vraiment un 'String Template'">
let template = `template : a=${a}   b=${b}`;
const a = 5, b = 6;
console.log(template); // template : a=undefined   b=undefined
		</az-format-code>
		
	 </az-slide>	
	    <az-slide>
    <div class="title">Arrows</div>
            <az-format-code file-name="Arrow functions" lang="js">
const numbers = [1,2,4,7,9,10,6,8,3,5];

numbers
  .map(n => n + 3)   // [4,5,7,10,12,13,9,11,6,8]
  
  .sort((a, b) => a>b)   // [4,5,6,7,8,9,10,11,12,13]
  
  .filter(n => n%2 === 0)   // [4,6,8,10,12]
  
  .forEach(n => console.log(n));   // 4 6 8 10 12
    </az-format-code>
    
        <az-format-code file-name="Arrow functions : curryfication">
function plusX(x) { return n => n+x; };

const plusUn = plusX( 1 );

console.log([1,2,3].map( plusUn ));  // [2,3,4]
    </az-format-code>
    </az-slide>
	
    <az-slide>
    <div class="title">Destructuring</div>
    <az-format-code file-name="Destructuring : list matching">
let a=0, b=1;
console.log(`a=${a} b=${b}`); // a=0 b=1

[a,b] = [b,a]; 

console.log(`a=${a} b=${b}`); // a=1 b=0    
    </az-format-code>

    <az-format-code file-name="Destructuring : parameters">
function test(p1, p2){
  console.log(`p1=${p1} p2=${p2}`);
}

test(8, 9); // p1=8 p2=9

let params = [10, 11];
test(...params); // p1=10 p2=11
    </az-format-code>
    
    
    <az-format-code file-name="Destructuring + default parameters = paramètres nommés !">
function describe({name: x, job: y = "boulanger"}) {
  console.log(`${x} est ${y}`);
}
describe({name: "Paul"}); // Paul est boulanger

describe({name: "Jean", job : "charcutier"}); // Jean est charcutier
    </az-format-code>
    
    </az-slide>
    
    <az-slide>
		 <div class="title">Modules : Import / Export</div>
        <az-format-code file-name="lib/text-utils.js">
export default function clean(str){
    return str.trim();
}
        </az-format-code>
        <az-format-code file-name="lib/math-utils.js">
const PI = 3.1416; // not visible
export plusun = n => n+1;
export moinsun = n => n-1;
export class MathBuilder{
    constructor(n) {    this.number = n; }
    incPI() { this.number += PI; return this;}
    build() { return this.number; }
    static of(n){return new MathBuilder(n);}
}
        </az-format-code>
        
        <az-format-code file-name="Import 1">
import * as math from "lib/math-utils"
console.log(`2 = ${math.plusun(1)}`);
        </az-format-code>
		<az-format-code file-name="Import 2">
import {plusun,moinsun} from "lib/math-utils"
console.log(`2 = ${plusun(1)}`));
        </az-format-code>
		<az-format-code file-name="Import 3">
import from "lib/text-utils"
console.log(`text = ${clean(" TOTO ")}`);
        </az-format-code>
		
    </az-slide>
    
    

    
     <az-slide>
	 <div class="title">Gestion des callbacks : Promises</div>
	 
    <az-format-code file-name="Promises : produce">
function getJSON(url) {
    return new Promise(function (resolve, reject) {
        let request = new XMLHttpRequest();
        request.open('GET', url);
        request.onload = () => {
          request.status == 200?
            resolve(JSON.parse(request.response)): // trigger 'success'
            reject(Error(request.statusText)); // trigger 'error'
        };
        request.onerror = e => {reject(Error(`Network Error(${url}) `))}; // trigger 'error'
        request.send();
    });
}
</az-format-code>
    <az-format-code file-name="Promises : consume (simple)">
getJSON('http://echo.jsontest.com/name/Jean-Paul').then(
    data => { console.log(`data received ${data.name}`);});
    </az-format-code>	
<az-format-code file-name="Promises : consume (handle errors)">
const errorHandler = error => console.log("error "+error);

getJSON('http://not.found.unkown/Jean-Paul').then(
  data => { console.log(`data received ${data.name}`);}, 
  errorHandler);
    </az-format-code>
</az-slide>
 <az-slide>
	 <div class="title">Combiner les Promises</div>
<az-format-code file-name="Promises : all">	
Promise.all([ 
  // Toutes les promesses doivent être tenues.
  getJSON('http://echo.jsontest.com/name/Jean-Paul'),
  getJSON('http://echo.jsontest.com/name/Jean-Luc'),
  getJSON('http://echo.jsontest.com/name/Jean-Pierre')

]).then( ([result1, result2, result3]) => { // retounrne un tableau avec chaque résultat
  
  console.log(`success: nom1='${result1.name}' nom2='${result2.name}' nom3='${result3.name}'`);

});
</az-format-code>

<az-format-code file-name="Promises : race">
Promise.race([ 

  // C'est le premier résultat reçu qui est retourné
  getJSON('http://echo.jsontest.com/name/Jean-Paul'),
  getJSON('http://echo.jsontest.com/name/Jean-Luc')

]).then( data => { console.log(`success: nom='${data.name}'`); });
</az-format-code>
    </az-slide>
 <az-slide>
	 <div class="title">Map / Set</div>    
	     <az-format-code file-name="Map">
let m = new Map().set("hello", 42).set(8, 'key34');

m.forEach((key, val) => console.log(`key=${key} val=${val}`));

console.log(`m contains hello ? ${m.has("hello")}`); // m contains hello ? true

    </az-format-code>	
	 	     <az-format-code file-name="Set">
let s = new Set().add("hello").add("goodbye").add("hello");

s.forEach(elt => console.log(`elt=${elt}`));

console.log(`s contains hello ? ${s.has("hello")}`); // s contains hello ? true
    </az-format-code>
 </az-slide>
    <az-slide>
    <div class="title">Webcomponents</div>
    Support<BR/>
    Polyfill<BR/>
    Features<BR/>
    <ul>
        <li>Custom Elements</li>
        <li>Shadow dom</li>
        <li>HTML Imports</li>
        <li>HTML Templates</li>
    </ul>
    Libraries<BR/>
    </az-slide>
        <az-slide>
<div class="title">Exemple de Web Component</div>   
<az-format-code file-name="js\es2015\components\az-format-code\az-format-code.js">
import 'prettify/prettify.js';
import 'prettify/prettify.css';
import 'prettify/styles/sunburst.css';
import replaceSpaces from "utilities/text-utils";

const template = `&lt;div class="code-title">&lt;/div>&lt;pre class="prettyprint">&lt;/pre>`;

class FormatCodeElement extends HTMLElement {

  createdCallback() { };
    
  attachedCallback() { this.render(); };
    
  attributeChangedCallback(attrName, oldVal, newVal) { this.render(); };
    
  render() {
    const coloredHTML = PR.prettyPrintOne(replaceSpaces(this.innerHTML.trim()), this.getAttribute("lang"));
    this.innerHTML = template;
    this.lastChild.innerHTML = coloredHTML;
    this.appendTitle(this.getAttribute("file-name"));
  }
  
  appendTitle(text){
    if(text) {
      this.firstChild.appendChild(document.createTextNode(text));
    }
  }
}
document.registerElement('az-format-code', FormatCodeElement);
</az-format-code>   
    
    </az-slide>
    
</az-presentation>
</body>
</html>





